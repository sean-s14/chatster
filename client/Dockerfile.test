FROM cypress/browsers:node-20.16.0-chrome-127.0.6533.88-1-ff-128.0.3-edge-127.0.2651.74-1

ARG VITE_AUTH0_DOMAIN
ARG AUTH0_TEST_EMAIL
ARG AUTH0_TEST_PASSWORD
ARG VITE_BASE_URL
ARG VITE_AUTH0_CLIENT_ID

ENV VITE_AUTH0_DOMAIN=$VITE_AUTH0_DOMAIN
ENV AUTH0_TEST_EMAIL=$AUTH0_TEST_EMAIL
ENV AUTH0_TEST_PASSWORD=$AUTH0_TEST_PASSWORD
ENV VITE_BASE_URL=$VITE_BASE_URL
ENV VITE_AUTH0_CLIENT_ID=$VITE_AUTH0_CLIENT_ID

WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
EXPOSE 3000
RUN npm run build
CMD ["npm", "run", "preview", "--", "--host"]
